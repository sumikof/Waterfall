# UAT ブラウザテスト実行サブエージェント

> **ステータス: 未実装（開発計画）**
> このファイルは開発計画を記載したプレースホルダーである。
> 実装完了後、このヘッダーを削除して運用に移行する。

---

## 開発計画

### 概要

Playwright を使用し、実際のブラウザ上でユーザー操作を再現して受入テストを実施するサブエージェント。
コード探索＋シナリオテスト実行（コードレビュー方式）を**補完する**位置づけであり、代替ではない。

### 前提条件

- webapp-testing スキル（Playwright 統合）の構築が完了していること
- テスト対象の Web アプリケーションが起動可能な環境であること
- Playwright がインストール済みであること（`pip install playwright && playwright install chromium`）

### 必要な開発作業

#### 1. webapp-testing スキルの構築

| ファイル | 内容 |
|---|---|
| `skills/webapp-testing/SKILL.md` | Playwright 統合のスキル定義。ブラウザ起動・画面操作・スクリーンショット・コンソールログ取得の手順 |
| `skills/webapp-testing/scripts/with_server.py` | サーバーライフサイクル管理スクリプト（起動→待機→テスト→停止） |
| `skills/webapp-testing/scripts/discover_elements.py` | ページ内の操作可能要素（ボタン・リンク・入力欄）を自動発見するヘルパー |
| `skills/webapp-testing/scripts/console_logger.py` | ブラウザコンソールのエラー・警告を記録するヘルパー |
| `skills/webapp-testing/references/playwright-guide.md` | Playwright の使い方リファレンス（セレクタ・Wait 戦略・アサーション） |

#### 2. ブラウザテスト実行エージェントプロンプト（本ファイル）

本ファイルを以下の構成で実装する：

```
## パラメータ
  PROJECT_ID, PROJECT_NAME, FEAT_ID, FEAT_NAME
  APP_URL: テスト対象 URL（例: http://localhost:3000）
  SERVER_CMD: サーバー起動コマンド（例: "npm run dev"）
  SERVER_PORT: サーバーポート番号
  BUG_ID_START: BUG-ID 開始番号
  PERSONA: ペルソナ定義テキスト
  UTC_LIST: ブラウザ検証対象の UTC テストケース一覧
  ROUTES: DSD-002 から抽出した当該 FEAT の画面 URL 一覧

## 実行手順
  Step 1: webapp-testing スキルの SKILL.md を読み込む
  Step 2: with_server.py でアプリケーションを起動する
  Step 3: 各 UTC について Playwright スクリプトを作成・実行する
    - ページ遷移、要素クリック、フォーム入力、結果確認
    - 各操作前後でスクリーンショットを取得する
    - コンソールエラーを記録する
  Step 4: テスト結果を判定する
    - OK: 期待どおりの画面表示・遷移が確認できた
    - NG: 画面表示の不一致・コンソールエラー・操作不能
  Step 5: 結果を返す（UTC 結果 + BUG 一覧 + スクリーンショットパス）
```

#### 3. オーケストレーターへの統合

`agents/acceptance-test.md` に Phase D（ブラウザテスト実行）を有効化する：

- Phase C（コードベース検証）完了後に Phase D を起動する
- Phase C と Phase D の結果を統合する際、同一 UTC に対する結果が異なる場合は NG を優先する
- ブラウザテスト結果にはスクリーンショットパスを含め、UAT-001 の備考欄に記載する

### 検証対象の選定基準

全 UTC をブラウザテストする必要はない。以下の基準で対象を絞る：

| 優先度 | 検証対象 |
|---|---|
| 必須 | 主要業務フローの画面遷移（正常系 E2E） |
| 必須 | フォーム入力・バリデーションの動作確認 |
| 推奨 | エラーメッセージの表示確認 |
| 推奨 | レスポンシブ対応の確認（主要画面のみ） |
| 任意 | 文言・レイアウトの詳細確認 |

### 依存関係

```
webapp-testing スキル構築
  ↓
ブラウザテストエージェント実装（本ファイル）
  ↓
オーケストレーター Phase D 有効化
  ↓
結合テスト・動作確認
```

### 見積もり

| 作業項目 | 規模 |
|---|---|
| webapp-testing スキル構築 | SKILL.md + スクリプト 3 本 + リファレンス 1 本 |
| 本エージェントプロンプト実装 | 本ファイルの計画部分をプロンプトに置換 |
| オーケストレーター統合 | agents/acceptance-test.md に Phase D ステップを追加 |
